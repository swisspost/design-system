@use 'air-datepicker/air-datepicker.css';
@use '@swisspost/design-system-styles/basics.scss';
@use '@swisspost/design-system-styles/components/validation.scss';
@use '@swisspost/design-system-styles/components/form-search-input.scss';
@use '@swisspost/design-system-styles/mixins/button' as button-mx;
@use '@swisspost/design-system-styles/tokens/helpers';
@use '@swisspost/design-system-styles/tokens/components' as components;
@use '@swisspost/design-system-styles/functions/tokens';
@use '@swisspost/design-system-styles/mixins/form-input' as input;
@use '@swisspost/design-system-styles/variables/elevation';
@use '@swisspost/design-system-styles/mixins/utilities';

tokens.$default-map: components.$post-datepicker;

.airdatepicker * {
  font-family: inherit;
}

.air-datepicker {
  /* --------------------------------------------
   * Variables
   * ------------------------------------------ */
  // --adp-padding: 8px; // post.datepicker.padding

  --adp-font-family: var(--post-device-font-family-default);
  --adp-font-size: var(--post-device-font-size-8);

  width: tokens.get('post-datepicker-width');
  border-radius: tokens.get('post-datepicker-border-radius');
  box-shadow: elevation.$elevation-300;
  font-weight: 700;
  border: none;

  --adp-cell-background-color-hover: unset;
  --adp-cell-background-color-in-range: unset;
  --adp-day-name-color: #050400; //post.datepicker.header.weekdays.color

  // // colors
  // --adp-color-disabled-in-range: #696864; //post.datepicker.in-range.grid.cell.disabled.color.fg
  // --adp-color-current-date: #050400; // post.datepicker.grid.cell.current.color.fg

  // --adp-day-name-color-hover: #fff; // post.datepicker.header.weekdays.color.hover (#fff)
  // --adp-nav-arrow-color: #050400; // post.datepicker.header.arrow.button.icon.color
  // --adp-nav-action-size: 40px; // post.datepicker.header.arrow.button.size
  // --adp-day-cell-width: 40px; // post.datepicker.grid.cell.size
  // --adp-day-cell-height: 40px; // post.datepicker.grid.cell.size
  // --adp-month-cell-height: 40px; // post.datepicker.grid.cell.size
  // --adp-year-cell-height: 40px; // post.datepicker.grid.cell.size
  // --adp-cell-border-radius: 100px; // post.datepicker.grid.cell.border-radius
  // --adp-cell-background-color-selected: #050400; // post.datepicker.grid.cell.selected.color.bg
  // --adp-cell-background-color-selected-hover: #504f4b; // post.datepicker.grid.cell.selected.hover.color.bg
  // --adp-cell-background-color-in-range-hover: #050400; // post.datepicker.grid.cell.in-range.hover.color.bg

  /* --------------------------------------------
   * Navigation
   * ------------------------------------------ */

  .air-datepicker--navigation {
    border-start-start-radius: inherit;
    border-start-end-radius: inherit;

    .air-datepicker-nav {
      border-start-start-radius: inherit;
      border-start-end-radius: inherit;
      border-block-end: none;
      background: tokens.get('post-datepicker-header-color-bg');
      padding: tokens.get('post-datepicker-header-nav-padding');

      .air-datepicker-nav--title {
        margin-right: auto;
        margin-inline-start: 0;
        justify-content: flex-start;
        display: flex;
        align-items: center;
        padding: 0 0 0 tokens.get('post-datepicker-header-dropdown-padding-inline-start');

        &:hover {
          background: unset;
        }

        button {
          border-radius: tokens.get('post-datepicker-border-radius');
          @include button-mx.reset-button;
          display: flex;
          align-items: center;
          gap: tokens.get('post-datepicker-header-dropdown-gap');
          @include utilities.focus-style();

          &:hover {
            color: tokens.get('post-datepicker-header-dropdown-color-hovered-fg');
          }
        }

        .placeholder {
          flex-grow: 2;
          pointer-events: none;
        }
      }

      .air-datepicker-nav--action {
        font-size: inherit;

        &[data-action='next'] {
          margin-inline-start: tokens.get('post-datepicker-header-chevrons-gap');
        }

        button {
          @include button-mx.reset-button;
          height: tokens.get('post-icon-button-small-outer', components.$post-icon-button);
          width: tokens.get('post-icon-button-small-outer', components.$post-icon-button);
          border-radius: tokens.get(
            'post-icon-button-border-radius-round',
            components.$post-icon-button
          );

          &:hover {
            color: tokens.get('post-datepicker-header-dropdown-color-hovered-fg');
          }
        }

        &:hover {
          background: unset;
        }
      }
    }
  }

  /* --------------------------------------------
   * Content
   * ------------------------------------------ */
  .air-datepicker--content {
    padding: 0 !important;

    .air-datepicker-body--day-names {
      background: tokens.get('post-datepicker-header-color-bg');
      margin: 0;
      padding-block-start: tokens.get('post-datepicker-header-weekdays-padding-block-start');
      padding-block-end: tokens.get('post-datepicker-header-weekdays-padding-block-end');
      padding-inline: tokens.get('post-datepicker-header-weekdays-padding-inline');

      .air-datepicker-body--day-name {
        text-transform: capitalize;
        font-size: inherit;
        color: tokens.get('post-datepicker-header-weekdays-color');
      }
    }

    .air-datepicker-body--cells {
      min-height: tokens.get('post-datepicker-grid-min-height');
      padding: tokens.get('post-datepicker-grid-padding');
      background: tokens.get('post-datepicker-grid-color-enabled-bg');

      .air-datepicker-cell {
        z-index: 0;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-shrink: 0;
        flex-direction: column;

        // days default
        color: tokens.get('post-datepicker-grid-day-cell-element-color-enabled-fg');
      }

      &.-days- {
        grid-template-columns: repeat(7, tokens.get('post-datepicker-grid-day-cell-size'));
        grid-auto-rows: tokens.get('post-datepicker-grid-day-cell-size');

        /* --------------------------------------------
     * Date Cells
     * ------------------------------------------ */
        .air-datepicker-cell {
          &.-day- {
            width: tokens.get('post-datepicker-grid-day-cell-size');
            height: tokens.get('post-datepicker-grid-day-cell-size');
            border-radius: tokens.get('post-datepicker-grid-cell-element-border-radius');

            // day focus
            &:not(.disabled) {
              @include utilities.focus-style();
            }

            // day hovered
            &:hover:not(.-disabled-, .-other-month-) {
              color: tokens.get('post-datepicker-grid-day-cell-element-color-hovered-fg');
              border-color: tokens.get('post-datepicker-grid-day-cell-element-color-hovered-bg');

              &:not(.-current-) {
                background: tokens.get('post-datepicker-grid-day-cell-element-color-hovered-bg');
              }
            }

            &.-other-month- {
              pointer-events: none;
            }

            // day selected
            &.-selected- {
              // z-index: 2;
              color: tokens.get('post-datepicker-grid-day-cell-element-color-selected-fg');
              background-color: tokens.get(
                'post-datepicker-grid-day-cell-element-color-selected-bg'
              );
              border: 2px solid
                tokens.get('post-datepicker-grid-day-cell-element-color-selected-border');
            }

            // day disabled (except other month which is disabled)
            &.-disabled-:not(.-day-.-other-month-) {
              user-select: none;
              color: tokens.get('post-datepicker-grid-day-cell-element-color-disabled-fg');
              border: 2px dashed
                tokens.get('post-datepicker-grid-day-cell-element-color-disabled-border');
              padding: tokens.get('post-datepicker-grid-day-cell-element-disabled-padding');
              width: 38px; // add a token for this
              height: 38px; // add a token for this
            }

            &.-current- {
              border: 2px solid
                tokens.get('post-datepicker-grid-day-cell-element-current-color-enabled-border');

              &:hover {
                border-color: tokens.get(
                  'post-datepicker-grid-day-cell-element-current-color-hovered-border'
                );
                color: tokens.get('post-datepicker-grid-day-cell-element-current-color-hovered-fg');
              }
            }
          }

          // &.-in-range-,
          // &.-range-from-,
          // &.-range-to- {
          //   position: relative;
          //   z-index: 0;

          //   &::before {
          //     content: '';
          //     z-index: -2;
          //     width: 40px;
          //     height: 40px;
          //     display: block;
          //     position: absolute;
          //     inset: 0;
          //     // post.datepicker.day.range.grid.cell.highlight.border.block.color

          //     &.-disabled- {
          //       user-select: none;
          //     }
          //   }
          // }

          // &.-in-range- {
          //   &::before {
          //     content: '';
          //     background: #ffcc00; // full yellow
          //     border-block: 2px solid #050400; // top & bottom border
          //   }
          // }

          // &.-range-from- {
          //   &::before {
          //     content: '';
          //     background: linear-gradient(to right, #fff 50%, #ffcc00 50%); // left half yellow
          //     border-block: 2px solid #050400; // top & bottom border
          //     border-inline-start: none; // remove left border
          //     border-radius: var(--adp-cell-border-radius) 0 0 var(--adp-cell-border-radius);
          //   }
          // }

          // &.-range-to- {
          //   &::before {
          //     content: '';
          //     background: linear-gradient(to right, #ffcc00 50%, #fff 50%); // right half yellow
          //     border-block: 2px solid #050400; // top & bottom border
          //     border-inline-end: none; // remove right border
          //     border-radius: 0 var(--adp-cell-border-radius) var(--adp-cell-border-radius) 0;
          //   }
          // }

          // &.-range-from-,
          // &.-range-to- {
          //   border: none;
          //   //
          //   // border-inline-end: none;\
          //   &::after {
          //     content: '';
          //     z-index: -1;
          //     width: 40px;
          //     height: 40px;
          //     display: block;
          //     position: absolute;
          //     border-radius: 100px;
          //     inset: 0;
          //     background: #050400;
          //   }
          // }

          // &:not(.-range-from-):not(.-range-to-):hover {
          //   color: #fff; // surface / lightest post.datepicker.in-range.edge.hover.color
          // }

          // &.-year-.-current-,
          // &.-month-.-current-,
          // &.-day-.-current- {
          //   border: 2px solid #050400; // post.datepicker.grid.cell.current.border
          //   border-radius: var(
          //     --adp-cell-border-radius
          //   ); // post.datepicker.grid.cell.current.border-radius
          // }

          // &.-day {
          //   &:focus {
          //     border-radius: tokens.get(
          //       'focus-border-radius',
          //       helpers.$post-focus
          //     ); // post.datepicker.grid.cell.focused.border-radius
          //     outline-offset: 2px; // post.datepicker.grid.cell.focused.outline-offset
          //   }
          // }

          // &.-disabled-:not(.-day-.-other-month-) {
          //   color: #504f4b;
          //   border: 2px dashed #504f4b; // post.datepicker.grid.cell.disabled.border
          //   width: 38px; // post.datepicker.grid.cell.disabled.size
          //   height: 38px; // post.datepicker.grid.cell.disabled.size
          // }

          // &.-year-.-other-decade-:not(.-selected-),
          // &.-day-.-other-month-:not(.-selected-) {
          //   color: rgba(0, 0, 0, 0.3) !important;

          //   // &:hover {
          //   //   color: #fff; //
          //   // }
          // }
        }
      }

      &.-years- {
        grid-template-columns: repeat(4, tokens.get('post-datepicker-grid-year-cell-width'));
        grid-auto-rows: tokens.get('post-datepicker-grid-year-cell-height');
        column-gap: tokens.get(
          'post-datepicker-grid-year-gap-inline'
        ); // this is applied wrong in figma !

        .air-datepicker-cell {
          &.-year- {
            width: tokens.get('post-datepicker-grid-year-cell-width');
            height: tokens.get('post-datepicker-grid-year-cell-height');
            border-radius: tokens.get('post-datepicker-grid-cell-element-border-radius');

            // year focus
            &:not(.disabled) {
              @include utilities.focus-style();
            }

            // year hovered
            &:hover:not(.-disabled-, .-current-) {
              color: tokens.get('post-datepicker-grid-year-cell-element-color-hovered-fg');
              background: tokens.get('post-datepicker-grid-year-cell-element-color-hovered-bg');
              border-color: tokens.get('post-datepicker-grid-year-cell-element-color-hovered-bg');
            }

            &.-other-decade- {
              color: unset;
            }

            // year selected
            &.-selected- {
              color: tokens.get('post-datepicker-grid-year-cell-element-color-selected-fg');
              background-color: tokens.get(
                'post-datepicker-grid-year-cell-element-color-selected-bg'
              );
              border: 2px solid
                tokens.get('post-datepicker-grid-year-cell-element-color-selected-border');
            }

            // year disabled (except other decade which is disabled)
            &.-disabled-:not(.-day-.-other-decade-) {
              user-select: none;
              color: tokens.get('post-datepicker-grid-year-cell-element-color-disabled-fg');
              border: 2px dashed
                tokens.get('post-datepicker-grid-year-cell-element-color-disabled-border');
            }

            &.-current- {
              border: 2px solid
                tokens.get('post-datepicker-grid-year-cell-element-current-color-enabled-border');

              &:hover {
                border-color: tokens.get(
                  'post-datepicker-grid-year-cell-element-current-color-hovered-border'
                );
                color: tokens.get(
                  'post-datepicker-grid-year-cell-element-current-color-hovered-fg'
                ); //wrong token  -> color assigned
              }
            }
          }
        }
      }

      &.-months- {
        grid-template-columns: repeat(4, 1fr);
        padding: 8px; // post.datepicker.month.grid.padding
        column-gap: 8px; // post.datepicker.month.grid.column-gap
        height: 216px; // post.datepicker.year.grid.height
        text-transform: uppercase;

        .air-datepicker-cell {
          &.-month- {
            width: tokens.get('post-datepicker-grid-month-cell-width');
            height: tokens.get('post-datepicker-grid-month-cell-height');
            border-radius: tokens.get('post-datepicker-grid-cell-element-border-radius');

            // month focus
            &:not(.disabled) {
              @include utilities.focus-style();
            }

            // month hovered
            &:hover:not(.-disabled-) {
              color: tokens.get('post-datepicker-grid-month-cell-element-color-hovered-fg');
              border-color: tokens.get('post-datepicker-grid-month-cell-element-color-hovered-bg');

              &:not(.-current-) {
                background: tokens.get('post-datepicker-grid-month-cell-element-color-hovered-bg');
              }
            }

            &.-other-decade- {
              color: unset;
            }

            // month selected
            &.-selected- {
              color: tokens.get('post-datepicker-grid-month-cell-element-color-selected-fg');
              background-color: tokens.get(
                'post-datepicker-grid-month-cell-element-color-selected-bg'
              );
              border: 2px solid
                tokens.get('post-datepicker-grid-month-cell-element-color-selected-border');
            }

            // month disabled (except other decade which is disabled)
            &.-disabled- {
              user-select: none;
              color: tokens.get('post-datepicker-grid-month-cell-element-color-disabled-fg');
              border: 2px dashed
                tokens.get('post-datepicker-grid-month-cell-element-color-disabled-border');
            }

            &.-current- {
              border: 2px solid
                tokens.get('post-datepicker-grid-month-cell-element-current-color-enabled-border');

              &:hover {
                border-color: tokens.get(
                  'post-datepicker-grid-month-cell-element-current-color-hovered-border'
                );
                color: tokens.get(
                  'post-datepicker-grid-month-cell-element-current-color-hovered-fg'
                ); //wrong token  -> color assigned
              }
            }
          }
        }
      }
    }

    /* --------------------------------------------
     * Misc
     * ------------------------------------------ */
  }
}

.calendar-input,
.calendar-input-range {
  position: relative;

  button {
    @include input.input-btn();
  }
}

.calendar-input-range {
  border: 2px solid black;
  border-radius: 4px;
  display: flex;
  padding: 12px;

  &.disabled {
    color: tokens.get('input-color-disabled-fg', components.$post-text-input);
    background-color: tokens.get('input-color-disabled-bg', components.$post-text-input);
    border-color: tokens.get('input-color-disabled-border', components.$post-text-input);
    border-style: tokens.get('input-border-style-disabled', components.$post-text-input);
  }
}

::slotted(input) {
  border: unset;
  background-color: transparent;
  flex-grow: 1;
}
