@use 'sass:map';
@use '../tokens/elements';
@use '../functions/tokens';
@use '../functions/icons';
@use './../mixins/icons' as icon-mixin;

tokens.$default-map: (
  post-validation-error: #b20000,
  post-validation-success: #107800,
  post-device-font-size-9: 14px,
  post-radio-button-icon-width-inner: 24px,
  post-radio-button-icon-height-inner: 24px,
  post-validation-list-gap-inline: 8px,
  post-input-spacing-padding-block-text-assist: 6px,
  post-input-spacing-padding-inline-text-assist: 2px
);

/*
Default feedback message classes
 */

.valid-feedback,
.invalid-feedback {
  display: none;
  align-items: center;
  width: 100%;
  margin: 0;
  padding: tokens.get('post-input-spacing-padding-block-text-assist')
    tokens.get('post-input-spacing-padding-inline-text-assist');
  font-size: tokens.get('post-device-font-size-9');
}

/*
 Valid input feedback
*/
.was-validated :valid ~ .valid-feedback,
.is-valid ~ .valid-feedback {
  color: tokens.get('post-validation-success');
  display: flex;
}

/*
 Invalid input feedback
*/

.was-validated :invalid ~ .invalid-feedback,
.is-invalid ~ .invalid-feedback {
  color: tokens.get('post-validation-error');
  display: flex;
}

/*
 Checkbox and Radio box specific classes
*/
input[type='checkbox'],
input[type='radio'],
input[type='range'] {
  ~ .invalid-feedback,
  ~ .valid-feedback {
    &::before {
      height: tokens.get('post-radio-button-icon-height-inner');
      width: tokens.get('post-radio-button-icon-width-inner');
      display: inline-block;
      margin-inline-end: tokens.get('post-validation-list-gap-inline');
      background-color: currentColor;
      content: '';
    }
  }

  ~ .invalid-feedback::before {
    @include icon-mixin.icon('val-error');
  }

  ~ .valid-feedback::before {
    @include icon-mixin.icon('val-success');
  }
}

/*
 Radio group with fieldset specific classes
*/

.was-validated fieldset:has(:valid),
.was-validated fieldset:has(:invalid),
fieldset:has(.is-valid),
fieldset:has(.is-invalid) {
  ~ .invalid-feedback,
  ~ .valid-feedback {
    &::before {
      height: tokens.get('post-radio-button-icon-height-inner');
      width: tokens.get('post-radio-button-icon-width-inner');
      display: inline-block;
      margin-inline-end: tokens.get('post-validation-list-gap-inline');
      background-color: currentColor;
      content: '';
    }
  }
}

.was-validated fieldset:has(:valid),
fieldset:has(.is-valid) {
  ~ .valid-feedback {
    display: flex;
    color: tokens.get('post-validation-success');

    &::before {
      @include icon-mixin.icon('val-success');
    }
  }
}

.was-validated fieldset:has(:invalid),
fieldset:has(.is-invalid) {
  ~ .invalid-feedback {
    display: flex;
    color: tokens.get('post-validation-error');

    &::before {
      @include icon-mixin.icon('val-error');
    }
  }
}
