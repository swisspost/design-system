import { Meta, Canvas, Source, Controls } from '@storybook/blocks';
import * as CCR from './aria-controls.stories';

<Meta of={CCR} />

# Aria-Controls

<div className="lead">
  In the Light DOM, `aria-controls` is used to indicate that an element controls the visibility or
  interaction of another element, by referencing its `id`.
</div>
<div>
  This creates an accessibility relationship, helping assistive technologies understand the
  interaction between the trigger and the controlled content.
</div>

### I. Referencing Within the Same DOM Tree ✔️

<ul>
  <li>Light DOM → Light DOM</li>

</ul>
  <Canvas of={CCR.ExampleHTML} sourceState="shown" />

### II. Referencing From the LightDOM Into That Shadow DOM ❌

<ul>
  <li>Light DOM → Shadow DOM</li>
  <li>Slotted Content → Shadow DOM</li>
</ul>

The `aria-controls` attribute cannot reference elements inside a Shadow DOM from the Light DOM. This is because IDs inside Shadow roots are encapsulated and inaccessible across boundaries, preventing valid accessibility relationships.

##### Possible Workarounds

###### 1. `Element:ariaControlsElements`

<b>Light DOM → Shadow DOM Example</b>
<Canvas of={CCR.Example2a} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example2a} />
</div>

<b>Slotted Content → Shadow DOM Example</b>
<Canvas of={CCR.Example2b} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example2b} />
</div>

###### 2. Set `aria-labelledby`on the host (for SSR Components: to be tested)

An option is to set the following attributes directly on the host of the target component:

<ul>
  <li> the `aria-labelledby`</li>
  <li> a semantic `role` (e.g. `textbox`, `button`)</li>
  <li> `tabindex="0"`</li>
</ul>

<b>Light DOM → Shadow DOM Example</b>
<Canvas of={CCR.Example2b} sourceState="shown" />

<b>Slotted Content → Shadow DOM Example</b>
<Canvas of={CCR.Example2b} sourceState="shown" />

### III. Referencing From Inside a Shadow DOM Out to the Light DOM ❌

<ul>
  <li>Shadow DOM → Light DOM</li>
  <li>Shadow DOM → Slotted Content</li>
</ul>

Similarly to the previous case, <b>referencing an element located outside a Shadow DOM from an element inside that Shadow DOM using standard `aria-labelledby` is not possible</b>. The strong encapsulation of the Shadow DOM prevents elements within it from directly accessing and referencing the IDs of elements in the Light DOM.

##### Possible Workaround

An option is to set the `id` directly on the host of the referencing element. Please note that, in this case all the visible text inside the referencing component will be assigned as the Accessible Name of the target element.

<Canvas of={CCR.Example2b} sourceState="shown" />

##### IV. Referencing From One Shadow DOM To Another Shadow DOM

<ul>
  <li>Shadow DOM → Other Shadow DOM</li>
</ul>

what happens

##### Possible Workaround

workaround text

<Canvas of={CCR.Example2b} sourceState="shown" />
