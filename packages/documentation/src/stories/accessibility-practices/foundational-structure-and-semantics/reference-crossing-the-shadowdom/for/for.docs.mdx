import { Meta, Canvas, Source, Controls } from '@storybook/addon-docs/blocks';
import * as CCR from './for.stories';

<Meta of={CCR} />

# for

##

<div className="lead">The native HTML `for`/`id` relationship is a fundamental way to connect a `<label>` element to a form control (such as `<input>`, `<select>`, `<textarea>`, etc. or even to a custom form-associated control) within the same document structure (same DOM tree).</div>

<div>This connection is established by setting the for attribute on the `<label>` to match the `id` attribute of the form control it describes. This relationship is crucial for accessibility, as it allows assistive technologies like screen readers to correctly associate and announce the label text when focus is placed on the associated input field, thereby making forms understandable and navigable.</div>

### I. Referencing Within the Same DOM Tree ✔️

<Canvas of={CCR.ExampleHTML} sourceState="shown" />

### II. Referencing From Outside a Shadow DOM Into That Shadow DOM ❌

<ul>
  <li>Light DOM → Shadow DOM</li>
  <li>Slotted Content → Shadow DOM</li>
</ul>

<p>When the referencing element (e.g. `<label for="...">`) is in the Light DOM and the target element is inside a Shadow DOM, the `for` attribute <b>cannot reference elements inside the Shadow DOM</b> using the standard id mechanism.</p>

##### Possible Workarounds

###### 1. `Element:ariaLabelledByElements`

Defines programmatically the `ariaLabelledByElements` property of the element: `this.internalEl.ariaLabelledByElements = [labelEl]`. This solution creates the relationship without the use of an `id`.

<b>Light DOM → Shadow DOM Example</b>
<Canvas of={CCR.Example2} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example2} />
</div>

<b>Slotted Content → Shadow DOM Example</b>
<Canvas of={CCR.Example3} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example3} />
</div>

###### 2. Set `aria-labelledby`on the host (for SSR Components) TO START EDIT THAT AND CHECK WITH FOCUS AND INPUT!!!

This solution involves setting the `aria-labelledby` directly on the host. In order for this solution to work, the host must have a set `role=""` along with `tabindex="0"`.
This defines the label text as the Accessible Name of the component, but NVDA does not announce it when an interactive element (e.g. an `<input>`) exists inside the component.

Directly setting `aria-labelledby` on the host.

<Canvas of={CCR.Example4} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example4} />
</div>

Setting `aria-labelledby` via `ElementInternals`.

<Canvas of={CCR.Example5} sourceState="shown" />
<div className="hide-col-default">
  <Controls of={CCR.Example5} />
</div>
