<script src="/assets/scripts/analytics-helper.js"></script>

<script data-id="GtmConstants">
  window?.gtm?.setConstant('ENVIRONMENTS', {
    dev: '%STORYBOOK_GTM_PAGE_CONTEXT_ENVIRONMENT_DEV%',
    int: '%STORYBOOK_GTM_PAGE_CONTEXT_ENVIRONMENT_INT%',
    prod: '%STORYBOOK_GTM_PAGE_CONTEXT_ENVIRONMENT_PROD%',
  });

  window?.gtm?.setConstant('ENVIRONMENT_FALLBACK', '%STORYBOOK_GTM_PAGE_CONTEXT_ENVIRONMENT_FALLBACK%');
</script>

<script data-id="GoogleTagManager">
  // Base
  (function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({ 'gtm.start': new Date().getTime(), 'event': 'gtm.js' });

    let f = d.getElementsByTagName(s)[0],
      j = d.createElement(s),
      dl = l != 'dataLayer' ? '&l=' + l : '';

    j.async = true;
    j.src = 'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
  })(window, document, 'script', 'dataLayer', '%STORYBOOK_GTM_KEY%');

  window.dataLayer = window.dataLayer || [];

  // Page Context
  window.addEventListener('storybook:ready', function() {
    window.dataLayer.push({
      event: 'page_context', // constant, required
      spa: 'true', // constant, required
      content_language: '%STORYBOOK_GTM_PAGE_CONTEXT_CONTENT_LANGUAGE%', // required
      content_geo_region: '%STORYBOOK_GTM_PAGE_CONTEXT_CONTENT_GEO_REGION%', // required
      source_code_version: '%STORYBOOK_GTM_PAGE_CONTEXT_SOURCE_CODE_VERSION%', // recommended
      page_name_language_neutral: window.gtm.getPageTitle(), // required
      page_url_language_neutral: window.location.href, // required
      environment: window.gtm.getEnvironment(), // required
      login_status: 'false', // required
      platform_name: 'ms_design_system', // required
      department_name: 'IT16.12', // required
      business_unit: 'IT', // required
      primary_segment: 'allgemein', // required
    });
  });

  // Page Change
  window.addEventListener('storybook:routeChange', function() {
    window.dataLayer.push({
      event: 'page_change', // constant, required
      content_language: '%STORYBOOK_GTM_PAGE_CONTEXT_CONTENT_LANGUAGE%', // required
      content_geo_region: '%STORYBOOK_GTM_PAGE_CONTEXT_CONTENT_GEO_REGION%', // required
      page_name_language_neutral: window.gtm.getPageTitle(), // required
      page_url_language_neutral: window.location.href, // required
      virtual_pageview: 'true', // SPA route change indicator, boolean true/false
      virtual_page_name: window.gtm.getPageTitle(), // SPA route change/transition new page name/page title
      virtual_url: window.location.href, // SPA route change new URL
    });
  });
</script>

<!-- Documentation: https://dev.to/masakudamatsu/favicon-nightmare-how-to-maintain-sanity-3al7 -->
<link rel="icon" href="/favicon.ico" sizes="any" />
<link rel="icon" href="/favicon.svg" type="image/svg+xml" />
<link rel="apple-touch-icon" href="/apple-touch-icon.png" />
<link rel="manifest" href="/site.webmanifest" />

<!-- customize the manager ui -->
<link rel="stylesheet" href="/manager/ui.css" />

<!-- customize the sidebar icons -->
<svg xmlns="http://www.w3.org/2000/svg" data-chromatic="ignore" style="position: absolute; width: 0px; height: 0px">
  <symbol id="icon--folder" viewBox="0 0 32 32">
    <path fill="currentColor" stroke="currentColor" stroke-width="1"
          d="M28.667 8H14.934c-.533 0-.933-.133-1.2-.4l-2.933-2.8c-.533-.533-1.333-.8-2.133-.8H3.335c-1.067 0-2 .933-2 2v22h29.333V10c0-1.067-.933-2-2-2zm.666 18.667H2.666V6c0-.4.267-.667.667-.667h5.333c.533 0 .933.133 1.2.4l2.8 2.8c.667.533 1.467.8 2.267.8h13.733c.4 0 .667.267.667.667v16.667z" />
  </symbol>
  <symbol id="icon--component" viewBox="0 0 32 32">
    <path fill="currentColor" stroke="currentColor" stroke-width="1"
          d="M28 9.333V4.266c0-.8-.8-1.6-1.6-1.6h-5.067c-.667 0-1.2.267-1.733.667l-1.733 1.733c-.133.133-.4.267-.8.267H5.6c-.8 0-1.6.8-1.6 1.6v2.4H0v20h32v-20h-4zm-22.667-2.4c0-.133.133-.267.267-.267h11.467c.667 0 1.2-.267 1.733-.667l1.733-1.733c.267-.133.533-.267.8-.267h4.933c.267 0 .4.133.4.267v5.067H5.333v-2.4zM30.667 28H1.334V10.667h29.333V28z" />
    <path fill="currentColor" stroke="currentColor" stroke-width="1" d="M10.667 14.667h10.667V16H10.667v-1.333z" />
  </symbol>
  <symbol id="icon--document" viewBox="0 0 32 32">
    <path fill="currentColor" stroke="currentColor" stroke-width="1"
          d="M5.333 2.667v26.666H20l6.667-6.666v-20H5.333zM20.667 26.78v-3.554h3.554l-3.554 3.554zm4.666-4.888h-6V28H6.667V4h18.666v17.893zM22.667 8.667H9.333V7.333h13.334v1.334zm0 4H9.333v-1.334h13.334v1.334zm0 4H9.333v-1.334h13.334v1.334z" />
  </symbol>
  <symbol id="icon--bookmarkhollow" viewBox="0 0 32 32">
    <path fill="currentColor" stroke="currentColor" stroke-width="1"
          d="M20.9 1.3H4.6c-1.1 0-2 .9-2 2v16l4.098-3.21v.338H6.7V30.6H28V8.4l-7.1-7.1zm.4 6.6V3.6l2.2 2.2L25.7 8h-4.4v-.1zM4.6 2.7h8.1c.3 0 .6.3.6.6v13.3l-3.8-3-.8-.6-.8.6-3.8 3V3.3c-.1-.3.2-.6.5-.6zm22.1 26.7H8V15.2l-.001.001v-.13L8.6 14.6l6 4.7v-16c0-.2 0-.4-.1-.6H20v6.6h6.7v20.1z" />
  </symbol>
</svg>
